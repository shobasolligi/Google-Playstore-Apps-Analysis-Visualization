SELECT * FROM dbo.Playstore_Apps_cleaned1
-- change Last update from Timestamp to Date

ALTER TABLE dbo.Playstore_Apps_cleaned1
ALTER COLUMN [Last Update] DATE


--1. Which apps have the highest rating in the given available dataset?

SELECT App,Rating FROM
dbo.Playstore_Apps_cleaned1
WHERE Rating=5
ORDER BY Rating DESC

--2. What are the number of installs and reviews for the above apps?Return the apps with the highest reviews to the top.
SELECT App,Installs,Reviews
FROM dbo.Playstore_Apps_cleaned1
WHERE Rating=5
ORDER BY Reviews DESC

--3. Which app has the highest number of reviews? Also, mention the number of reviews and category of the app.
SELECT top 1 App,Reviews,Category
FROM dbo.Playstore_Apps_cleaned1
ORDER BY Reviews DESC

--4. What is the total amount of revenue generated by the google play
--store by hosting apps? (Whenever a user buys apps from the
--google play store, the amount is considered in the revenue)


select sum(Installs*Price) Total_Revenue
FROM dbo.Playstore_Apps_cleaned1


--5. Which Category of google play store apps has the highest number of installs? also, find out the total number of installs for that particular category.
--A
SELECT top 1 Category,Installs
FROM dbo.Playstore_Apps_cleaned1
ORDER BY Installs DESC

--B. "Game"
SELECT top 1 Category, sum(Installs) total
FROM dbo.Playstore_Apps_cleaned1
GROUP BY Category
ORDER BY total DESC

--6. Which Genre has the most number of published apps? A. Tools
SELECT top 1 Genres, count(App) AS app_count
FROM dbo.Playstore_Apps_cleaned1
GROUP BY Genres
ORDER BY app_count DESC

--7. Provide the list of all games ordered in such a way that the gamethat has the highest number 
--of installs is displayed on the top
--(to avoid duplicate results use distinct)

SELECT DISTINCT App, sum(Installs) Total
FROM dbo.Playstore_Apps_cleaned1
WHERE App LIKE '%Games%'
GROUP BY App
ORDER BY Total DESC

--8. Provide the list of apps that can work on android version 4.0.3 and
--UP.
SELECT App,[Android Ver] 
FROM dbo.Playstore_Apps_cleaned1
WHERE [Android Ver]='4.0.3 and up'

--9. How many apps from the given data set are free? Also, provide the
--number of paid apps.

SELECT Type, count(App) Total_apps
FROM dbo.Playstore_Apps_cleaned1
GROUP BY Type
ORDER BY Total_apps DESC

--10. Which is the best dating app? (Best dating app is the one having
--the highest number of Reviews)

SELECT TOP 1 App, Reviews
FROM dbo.Playstore_Apps_cleaned1
WHERE Category='DATING'
ORDER BY Reviews DESC



--11. Get the number of reviews having positive sentiment and number
--of reviews having negative sentiment for the app 10 best foods for
--you and compare them.

SELECT App,Sentiment,count(Sentiment) senti
FROM dbo.playstore_reviews1
GROUP BY Sentiment,App
HAVING App LIKE'10 Best Foods for You'
ORDER BY senti DESC

--12. Which comments of ASUS SuperNote have sentiment polarity
--and sentiment subjectivity both as 1?

SELECT App,Translated_Review,Sentiment_Polarity,Sentiment_Subjectivity
FROM dbo.playstore_reviews1
WHERE App='ASUS SuperNote'
AND Sentiment_Polarity=1
AND Sentiment_Subjectivity=1

--13. Get all the neutral sentiment reviews for the app Abs Training-
--Burn belly fat

SELECT App,Translated_Review,Sentiment
FROM dbo.playstore_reviews1
WHERE App='Abs Training-Burn belly fat'
AND Sentiment='Neutral'

--14. Extract all negative sentiment reviews for Adobe Acrobat
--Reader with their sentiment polarity and sentiment subjectivity

SELECT Translated_Review,Sentiment_Polarity,Sentiment_Subjectivity
FROM dbo.playstore_reviews1
WHERE App='Adobe Acrobat Reader'
AND Sentiment='Negative'


SELECT * FROM dbo.playstore_reviews1